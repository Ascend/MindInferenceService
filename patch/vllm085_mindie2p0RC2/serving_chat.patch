35a36,46
> ENABLE_MIS_GUIDED_DECODE = True
> try:
>     from mis.model_executor import (
>             get_local_xgrammar_npu_guided_decoding_logits_processor, xgr_installed,
>             enable_mis_xgrammar)
>     if not enable_mis_xgrammar:
>         ENABLE_MIS_GUIDED_DECODE = False
> except ImportError:
>     logger.warning("unable to load mis guided decode params!")
>     ENABLE_MIS_GUIDED_DECODE = False
>
218a219,238
>
>                 # xgrammar adapted to npu
>                 if sampling_params.guided_decoding is not None and ENABLE_MIS_GUIDED_DECODE:
>                     logger.info("enable mis guided decode, initilize xgrammar-npu!")
>                     if not xgr_installed:
>                         logger.warning("xgrammar has not been installed! Fail to initialize xgrammar-npu.")
>                     else:
>                         processor = await get_local_xgrammar_npu_guided_decoding_logits_processor(
>                             guided_params=sampling_params.guided_decoding,
>                             tokenizer=tokenizer,
>                             model_config=self.model_config
>                         )
>
>                         if processor and sampling_params.logits_processors is None:
>                             sampling_params.logits_processors = []
>                         if processor:
>                             sampling_params.logits_processors.append(processor)
>
>                         # Unset guided decoding params after